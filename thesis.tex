\documentclass{report}
\usepackage{textcomp}
\usepackage{mathtools}
\usepackage{enumitem}
\usepackage{cite}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{float}
\usepackage[toc,page]{appendix}
\usepackage[margin=1in]{geometry}
\usepackage[doublespacing]{setspace}



\graphicspath{ {images/} }
\widowpenalty=1500
\clubpenalty=1500

\titlespacing*{\chapter}{0pt}{0pt}{20pt}
\titleformat{\chapter}[display] {\normalfont\bfseries}{}{0pt}{\centering \LARGE}

\begin{document}
	\begin{titlepage} \begin{singlespace}
        \begin{center} \begin{large}
            UNIVERSITY of CALIFORNIA \\ SANTA CRUZ

            \vspace{\baselineskip}

            \textbf{Adventures in Firing a 30-Year-Old Metal-Cutting Laser \\ at Extremely Sensitive Electronic Circuits \\ and Trying to Not Break Anything}

            \vspace{\baselineskip}

            A thesis submitted in the hope that \\ any future researchers on this project

            \vspace{\baselineskip}

            DO NOT MAKE THE SAME MISTAKES THAT I DID

            \vspace{\baselineskip}

            and

            \vspace{\baselineskip}

            ARE ABLE TO PRODUCE GOOD RESULTS

            \vspace{\baselineskip}

            by

            \vspace{\baselineskip}

            \textbf{Christopher D. Milke}

            \vspace{\baselineskip}

            \today

            \vspace*{\fill}

            \end{large}
        \end{center}

	\end{singlespace} \end{titlepage}


    %copyright
    \newpage \begin{center} \pagenumbering{roman}
        \vspace*{\fill}
        Copyright \textcopyright by

        Christopher D. Milke 

        2016
        \vspace*{\fill}
    \end{center} \newpage


    %abstract
    \addcontentsline{toc}{chapter}{Abstract}
        \begin{center} \LARGE \textbf{Abstract} \end{center}

        TODO: abstract

    \newpage


    \tableofcontents


    %dedication and acknowledgments
    \newpage \vspace*{\fill}
        \addcontentsline{toc}{chapter}{Dedication}
        \begin{center} \begin{large}
            Dedicated to all of the brave sensors\\
            who gave their lives in the name of science.
        \end{large} \end{center}
    \vspace*{\fill} \newpage \vspace*{\fill}
        \addcontentsline{toc}{chapter}{Acknowledgements}
        \begin{center} \begin{large}
            \large \textbf{Acknowledgements} \vspace{\baselineskip}

            TODO: acknowledgments

        \end{large} \end{center}
    \vspace*{\fill} \newpage





    \chapter{ Background }
        \pagenumbering{arabic} \setcounter{page}{1}
        TODO: Background





    \chapter{ Setup }
        \section{ Laser Injection Testing }
            %setup circuit, put in laser filter
            \subsection{ Preperation }
                %oscilloscope setup
                The first step to performing laser injection analysis is to turn on the Tektronix TDS 5054 Oscilloscope, as it takes a while to boot up. Once it is on and the oscilloscope screen is visible, make sure the settings are sane. The viewing window settings are visible in figure [TODO: figure-oscilloscope window]. Additionally, the appendices provide instructions on setting up the details of the oscilloscope (see section [TODO: section-oscilloscope instructions]).

                %intro
                The next (and most important) step to performing laser injection testing is making sure you use the probe station that is equipped with the Alessi Cutting Laser, visible in figure [TODO: figure-wide angle shot of the laser in the station]. Then you need to set up the circuit. Three probes are needed for the laser injection test. The convention I've used is a probe on each side at the back of the probe platform, with the third probe on the right towards the front of the platform, as visible in figure [TODO: picture-setup].

                %power supply circuit
                The probe at the front of the platform (the "bias probe", as it will be used to bias the sensor) should have a standard coaxial cable connecting it to the ground terminal of the splitter box. The high voltage ouput of the splitter should be connected to the probe station chuck. And the Triaxial input to the splitter should be attached to a power supply capable of ouputting a kilovolt. 
                
                %copper wire loop
                The probe barrels of all three probes need to be attached to each other with small pieces of copper wire and aligator clips. The reason for this is to ensure that everything is properly grounded. If you fail to do this, data you receive on the oscilloscope with be useless (see figure [TODO: figure-side by side comparison of grounded to floating]). Additionally, you want to make sure that the copper wire loop is as small as possible. The loop acts like an inductor that introduces unwanted noise to the system. Minimizing the size of the loop reduces noise it produces. See figure [TODO: figure-side by side comparison of good copper loop to bad copper loop] for an example of how this should look.

                %voltage dividers
                Two of the probes need special voltage dividers attached to them. By my convention, these are always the two probes at the back of the station (in general, they are the probes you intend to touch down on the dc pads). Unscrew the coaxial cables from the probe barrels, and attach the voltage dividers in their place. There are two voltage dividers, labelled "1" and "2". It \textit{does} matter which probe they are plugged into. The voltage divider labelled "1" should be plugged into the "near" dc-pad probe, and "2" should be plugged into the "far" dc-pad probe. "Near" and "far" are terms that will be used many times, and refer to the dc-pad nearest to the sensor's bias resistor, and the dc-pad furthest from the bias resistor. More on this in the next section. By my convention, "1" is always plugged into the left probe, and "2" into the right probe (see figure [TODO: picture-setup] again).
                
                %differential probes
                The reason for these voltage dividers is to protect the Tektronix differential probes. The differential probes are only rated to 25 volts, while the sensor's dc pads can output several hundred volts. The differential probes need to be plugged into the voltage dividers on one end, and into the Tektronix TDS 5054 Oscilloscope (CH1 and CH2) on the other. The settings for both differential probes should be set as shown in figure [TODO: figure-diff probes settings]. That is, "DC reject" should be set to off, "bandwidth" should be set to 200 MHz, and "attenuation" should be set to "divide by 10".

                %Laser filter
                The last step before getting a sensor is making sure the laser is ready. Find the neutral density filter cylinder (figure [TODO: figure-filter holster]) and make sure the filter you intend to use has been placed in the cylinder and rotated into position in front of the laser beam. Be very careful to make sure you are using one of the more powerful filters, as using the weaker filters will result in damage to the sensor (see section [TODO: section-laser filter labels/which are good or bad]). Locate the the laser power box, insert the safety key, and arm the laser. Do not turn the laser on yet. It is now time to get the sensor ready.

            %touch down on sensor pads, aim laser, turn laser on
            \subsection{ Readying the Test Sensor }
                %place sensor, touch down
                Place the test sensor onto the chuck. By my convention, I always make sure that the bias resistors, visible in figures [TODO: figure-two different zoom levels of the bias resistors], are on the left. Time to touch down. Pick a strip number. The "near" probe should touch down onto the dc-pad nearest the bias resistor on that strip, and the "far" probe should touch down on the dc-pad furthest from the bias resistor on that strip. The bias probe should of course touch down on the bias ring. See figures [TODO: figure of the pobes touched down and of the dc pads].

                %aim ze lazer
                The last step before you can start testing is to aim the laser. This must be done using the high ([TODO: info-find mag level]) magnification lens, but \textit{not} using the extra 2X magnification. There are two locations we typically aim the laser at, near the bias resistor and far away from the bias resistor. Figures [TODO: figure-laser aiming locations] show exactly where I usually aim the laser. Precise aiming of the laser is accomplished using the CRT microscope viewing monitor. There are two pairs of tape on the screen, which act as crosshairs. One pair is for when the microscope is at 1X magnification, the second pair for 2X magnification (only used when you intend to actually cut things). See figure [TODO: figure-microscope screen]. With the laser aimed, turn off the viewing light and close up the probe station (the light will break the sensor when biased, and the laser will not operate with the station open).

            %FIRE ZEE LAZER!!! (every 3 s. max...). Filter out double peaks. Watch for damage
            \subsection{ FIRE ZE LAZER!!! (carefully): \\ Laser and Oscilloscope Operation }
                %warning
                Before we go any further, I should make something clear: You are testing a very fragile and sensitive piece of electronic equipement that can be damaged with a misdirected flashlight. You are about to shoot directly at it with a laser \textit{that can make craters in metal}. In my time doing these tests I have amassed an entire graveyard of sensors which were damaged or destroyed because of this laser. I cannot stress enough how important it is to be careful and patient with this part of the experiment. Negligence \textit{will} result in your sensor being rendered untestable at best, and outright destroyed via laser ablation at worst (figure [TODO: example of what happens when you aren't careful]).

                %turning on the laser
                With that out of the way, the first thing to do is to turn on the sensor power supply. Assuming you wired everything up correctly, you want to bias the sensor with negative voltage. I've found that the best place to start is by biasing to -50 volts, as the laser is less likely to damage the sensor at this voltage. Once you've assured yourself that you have a solid bias connection, it is time to turn on the Alessi Power Supply. As of writing this thesis, you will want to set the laser power 511. As mentioned in section [TODO: section-laser issues], the laser power that we can operate at does not seem to be consistent, and you may need to use a different value. The important thing is to not go too high. Using too large a value here is guaranteed to break the sensor.

                %initial test fire
                With the laser power set, you can now finally fire the laser... every 3-5 seconds. For the safety of both the laser and the sensor, you are prohibited from firing the laser any more than once every three seconds. Because I am paranoid, I always prefer to fire only every five seconds. The laser can be triggered with the trigger switch on the laser power supply or, more conveniently, with the attached foot peddle. Fire the laser and watch the oscilloscope. If you are lucky, you should see a sudden spike (or pair of spikes) like in figure [TODO: figure-example 50V spike]. However, the Alessi laser is nothing if not inconsistent, which mean you may have to fire the laser several times (once every 3-5 seconds...) before you see such a spike. It is not unusual to have to wait up to 20 shots before seeing a spike. If you do not see a spike after that many laser triggerings though, you should check your probes' connections to the dc pads.

                %what to watch for
                Upon seeing a pulse and confirming that your oscilloscope probes are properly touched down, you can begin recording data. Fire the laser as many times as you need, at whatever bias voltages you need. While doing so however, pay very close to attention to both the shape of the spikes you see, and the leakage current running through the sensor (visible on the power supply). There are two things that can go wrong with the spike shape. The first is that you can get a "double peak", as visible in figure [TODO: figure-double peak]. A double peak (and at high enough laser powers a triple peak) like this indicates that the laser fired twice in a very short period of time. As our experiments are always concerned with only single pulse spikes, you need to throw away these double peak pulses. 
                
                %marks of death
                The second pulse shape to watch for is much more concerning. I refer to them as damage spikes, or marks of death. They come in three forms, visible in figures [TODO: figure-damage spikes(sharp up, rounded, and tiny pulse)]. An occurance of one of these indicates that you are beginning to damage the strip you are shooting at. As was discussed in section [TODO: section-ptp tests], this damage is permanent, but is limited almost entirely to that strip. If you see a damage spike, STOP. You are officially playing russian roulette with the sensor, and any laser shot from that point on risks globally damaging the sensor. Which leads us to the second aspect you need to pay attention to while testing sensors: the leakage current.

                %leakage current
                After every pulse of the laser, take a glance at the leakage current through the sensor. If, upon triggering the laser, the leakage current suddenly jumps up several orders of magnitude, STOP. The sensor has been globally damaged. Technically the sensor is still usable, but I would strongly recommend that you no longer use it for laser injection testing. Firing the laser at such a sensor will only cause the leakage current to rise higher, eventually maxing out the power supply's maximum compliance rating and rendering the sensor completely unusable. Assuming that you manage to skirt disaster though, and are able to export your data, we need to look at some post-processing.

            %python!!!
            \subsection{ Post-Experiment Analysis }
                %initial sweep: smooth data, remove offset
                The post-processing of the data for this experiment is fairly starghtfoward, and ultimately amounts to plotting the peak voltages of the various measurements against the bias voltage those measurements were taken at. There are a couple of caveats to obtaining this value however. The first step in this process is to smooth out the data and set a proper baseline. Smoothing the data out is a straightforward process that simply uses a running mean to make the data less erratic. As for the baseline, the voltage going through the probes/differential probes/oscilloscope tends to be very slightly offset from zero. As such we need to shift all the data points slightly to get the proper relative values. This is done by \textbf{assuming} that the first several data points (my algorithm uses the first 5\%) are flat, with no pulse data. When configuring the oscilloscope, you should ensure that the trigger point is not too far to the left, so that this assumption remains true.
                

                %remove inductance spike, find laser pulse
                Once the data is smoothed out and corrected for the dc offset, the next step is to sort through the measurement data from a pulse and locate the actual spike. Due to the way the experiment is setup, firing the laser causes inductance in the oscilloscope probes, leading to a very sharp spike being captured by the oscilloscope, as seen in figure [TODO:inductance spike]. In fact, in the majority of cases, this inductance spike is what the oscilloscope triggers off of. In order to avoid confusing the analysis, this inductance spike is removed. Fortunately, this is a simple matter, because while the pulse caused by the laser is purely negative, the inductance spike is both negative and positive. With the data now appropriately cleaned up, the laser pulse can be easily identified by simply being the most negative voltage of the data.

                %laser peak clipping
                Finding the laser peak is not quite the end though. Due to another quirk of the setup (again, possibly because of inductance...), the peak that appears on the oscilloscope is higher than the actual maximum voltage going through the strip of the sensor. It was found in previous studies that this additional perceived voltage is related to the rise time of the laser pulse; the shorter the rise time, the higher the pulse. Calibrations were performed to accurately measure this dependence. We use the data from those calibrations in combination with the rise time of the laser pulse in order to determine how distorted the laser pulse tip is. Finally, the laser pulse is then trimmed down by an appropriate amount, and the finished peak data can be used for further study.



    \chapter{ What We Have Previously (Unsucessfully) Tried\\ AKA: What Not To Do }





    \chapter{Appendices}





\end{document}
